"use strict";(self.webpackChunkcool_blog=self.webpackChunkcool_blog||[]).push([[478],{478:(e,s,t)=>{t.r(s),t.d(s,{default:()=>C});var n=t(43),a=t(3),c=t(615),o=t(510),r=t(149);var l=t(602),i=t(88),d=t(987),m=t(661),p=t(22);const u="new-comment_styles_message-box__87kCb",h="new-comment_styles_btn-container__0FgE1";var _=t(579);const j=e=>{let{postId:s,userDisplayName:t,updateComments:a}=e;const[c,o]=(0,n.useState)(!1),l=(0,n.useRef)();return(0,_.jsxs)("div",{children:[(0,_.jsx)("textarea",{placeholder:" write a comment",rows:"2",ref:l,className:u}),(0,_.jsx)("div",{className:h,children:(0,_.jsx)("button",{onClick:async()=>{const e=l.current.value.trim();if(0===e.length)return;o(!0);await(0,r.cc)(e,t,s)?(l.current.value="",a()):alert("posting comment failed"),o(!1)},disabled:c,children:"Post it"})})]})},x="comments_styles_sign-in-wrapper__-HH79",g="comments_styles_lnk-sign-in__mjK1f",w="comments_styles_comment-wrapper__9wHnx",y="comments_styles_user__5Vrld",v=e=>{let{comments:s,postId:t}=e;const[c,o]=(0,n.useState)([]);(0,n.useEffect)(()=>{o(s)},[s]);const i=(0,a.wA)(),d=(0,a.d4)(p.x),u=(0,n.useCallback)(async()=>{const e=await(0,r.gU)();i((0,m.l)(e.user))},[]);return(0,_.jsxs)("div",{children:[(0,_.jsx)("hr",{}),!d&&(0,_.jsxs)("div",{className:x,children:[(0,_.jsxs)("span",{className:g,onClick:u,children:["Sign In ",(0,_.jsx)("br",{})]}),(0,_.jsx)("span",{children:" To Post Your Comment"})]}),d&&(0,_.jsx)(j,{postId:t,userDisplayName:d.displayName,updateComments:e=>{o(e)}}),c&&c.sort((e,s)=>s.createdAt-e.createdAt).map(e=>(0,_.jsx)("div",{children:(0,_.jsxs)("div",{className:w,children:[(0,_.jsx)("div",{className:y,children:e.user}),(0,_.jsx)("div",{children:e.comment}),(0,_.jsx)("div",{className:["comment-date"],children:(0,l.H)(e.createdAt)})]})},e.createdAt))]})};var k=t(84);const b="post-detail-page_styles_bookmark-icon__zCw6r",f="post-detail-page_styles_post-date__E9uuU",N="post-detail-page_styles_image-container__iZpwv";const C=function(){const e=(0,a.wA)(),{slug:s}=(0,c.g)(),[t,m]=(0,n.useState)(""),[p,u]=(0,n.useState)(null),[h,j]=(0,n.useState)(!0),[x,g]=(0,n.useState)(null),w=(0,a.d4)(i.Np);return(0,n.useEffect)(()=>{const e=(async(e,s)=>{const t=await fetch(e),n=t.headers.get("content-type")||"";return!t.ok||"md"===s&&!n.includes("markdown")||"json"===s&&!n.includes("json")?Promise.reject(new Error("Fetch Data Failed")):"md"===s?t.text():"json"===s?t.json():Promise.reject(`Not Support Data Type ${s}!`)})(`/cool-blog/contents/posts/${s}.md`,"md"),t=(0,r.tY)(s);Promise.all([e,t]).then(e=>{m(e[0]),u(e[1])}).catch(e=>{console.error("\ud83d\udd25 Fetch error:",e),g(e.message)}).finally(()=>{j(!1)})},[s]),(0,_.jsxs)(n.Fragment,{children:[h&&(0,_.jsx)("p",{children:"Loading..."}),x&&(0,_.jsx)("p",{children:x}),p&&(0,_.jsxs)(n.Fragment,{children:[(0,_.jsxs)("h1",{children:[(0,_.jsx)("span",{children:p.title}),(0,_.jsx)(k.h,{className:b,title:"Bookmark this post",onClick:()=>e((0,d.bM)(w,{data:p,id:s}))}),(0,_.jsxs)("div",{className:f,children:["Posted on ",(0,l.Z)(p.date)]})]}),(0,_.jsx)(o.oz,{components:{img(e){let{node:t}=e;const n=t.properties.src.replace(/^(\.\/|\/)/,"");return(0,_.jsx)("span",{className:N,children:(0,_.jsx)("img",{src:`/cool-blog/images/posts/${s}/${n}`,alt:t.properties.alt,width:"600",height:"300"})})}},children:t}),(0,_.jsx)(v,{comments:p.comments,postId:s})]})]})}}}]);
//# sourceMappingURL=478.12f4252c.chunk.js.map