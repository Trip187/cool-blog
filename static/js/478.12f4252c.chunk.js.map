{"version":3,"file":"static/js/478.12f4252c.chunk.js","mappings":"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","sources":["webpack://cool-blog/./src/components/comments/new-comment.styles.module.css?38a8","components/comments/new-comment.component.js","webpack://cool-blog/./src/components/comments/comments.styles.module.css?de3a","components/comments/comments.component.js","webpack://cool-blog/./src/pages/post-detail-page.styles.module.css?5393","pages/post-detail-page.component.js","utils/fetch-data.utils.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"message-box\":\"new-comment_styles_message-box__87kCb\",\"btn-container\":\"new-comment_styles_btn-container__0FgE1\"};","import { useState, useRef } from \"react\";\r\nimport { addCommentToPost } from \"../../utils/firebase.utils\";\r\nimport classes from \"./new-comment.styles.module.css\";\r\n\r\nconst NewComment = ({ postId, userDisplayName, updateComments }) => {\r\n  const [isPending, setIsPending] = useState(false);\r\n  const commentRef = useRef();\r\n\r\n  const postCommentHandler = async () => {\r\n    const newComment = commentRef.current.value.trim();\r\n    if (newComment.length === 0) {\r\n      return;\r\n    }\r\n    setIsPending(true);\r\n    const res = await addCommentToPost(newComment, userDisplayName, postId);\r\n\r\n    if (res) {\r\n      commentRef.current.value = \"\";\r\n      updateComments();\r\n    } else {\r\n      alert(\"posting comment failed\");\r\n    }\r\n    setIsPending(false);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <textarea\r\n        placeholder=\" write a comment\"\r\n        rows=\"2\"\r\n        ref={commentRef}\r\n        className={classes[\"message-box\"]}\r\n      />\r\n\r\n      <div className={classes[\"btn-container\"]}>\r\n        <button onClick={postCommentHandler} disabled={isPending}>\r\n          Post it\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default NewComment;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"sign-in-wrapper\":\"comments_styles_sign-in-wrapper__-HH79\",\"lnk-sign-in\":\"comments_styles_lnk-sign-in__mjK1f\",\"comment-wrapper\":\"comments_styles_comment-wrapper__9wHnx\",\"user\":\"comments_styles_user__5Vrld\",\"comment-date\":\"comments_styles_comment-date__PsiXw\"};","import { useCallback, useEffect, useState } from \"react\";\r\n\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\n\r\nimport { signInWithGooglePopup } from \"../../utils/firebase.utils\";\r\n\r\nimport { getLongDate } from \"../../utils/datetime.utils\";\r\n\r\nimport { setCurrentUser } from \"../../store/user/user.action\";\r\n\r\nimport { selectCurrentUser } from \"../../store/user/user.selector\";\r\n\r\nimport NewComment from \"./new-comment.component\";\r\n\r\nimport classes from \"./comments.styles.module.css\";\r\n\r\nconst Comments = ({ comments, postId }) => {\r\n  const [commentsList, setCommentsList] = useState([]);\r\n\r\n  useEffect(() => {\r\n    setCommentsList(comments);\r\n  }, [comments]);\r\n  const dispatch = useDispatch();\r\n  const currentUser = useSelector(selectCurrentUser);\r\n\r\n  const signInWithGoogle = useCallback(async () => {\r\n    const response = await signInWithGooglePopup();\r\n    dispatch(setCurrentUser(response.user));\r\n  }, []);\r\n\r\n  const updateComments = (NewComment) => {\r\n    setCommentsList(NewComment);\r\n  };\r\n  return (\r\n    <div>\r\n      <hr />\r\n      {!currentUser && (\r\n        <div className={classes[\"sign-in-wrapper\"]}>\r\n          <span className={classes[\"lnk-sign-in\"]} onClick={signInWithGoogle}>\r\n            Sign In <br />\r\n          </span>\r\n          <span> To Post Your Comment</span>\r\n        </div>\r\n      )}\r\n      {currentUser && (\r\n        <NewComment\r\n          postId={postId}\r\n          userDisplayName={currentUser.displayName}\r\n          updateComments={updateComments}\r\n        />\r\n      )}\r\n      {commentsList &&\r\n        commentsList\r\n          .sort((a, b) => b.createdAt - a.createdAt)\r\n          .map((c) => (\r\n            <div key={c.createdAt}>\r\n              <div className={classes[\"comment-wrapper\"]}>\r\n                <div className={classes[\"user\"]}>{c.user}</div>\r\n                <div>{c.comment}</div>\r\n                <div className={[\"comment-date\"]}>\r\n                  {getLongDate(c.createdAt)}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n    </div>\r\n  );\r\n};\r\nexport default Comments;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"bookmark-icon\":\"post-detail-page_styles_bookmark-icon__zCw6r\",\"post-date\":\"post-detail-page_styles_post-date__E9uuU\",\"image-container\":\"post-detail-page_styles_image-container__iZpwv\"};","import { Fragment, useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport ReactMarkdown from \"react-markdown\";\r\nimport { getPostById } from \"../utils/firebase.utils\";\r\nimport { fetchData } from \"../utils/fetch-data.utils\";\r\nimport { getShortDate } from \"../utils/datetime.utils\";\r\nimport { selectBookmarkItems } from \"../store/bookmark/bookmark.selector\";\r\nimport { addItemToBookmarks } from \"../store/bookmark/bookmark.action\";\r\nimport Comments from \"../components/comments/comments.component\";\r\nimport { ReactComponent as BookmarkIcon } from \"../assets/icons/bookmark.svg\";\r\nimport classes from \"./post-detail-page.styles.module.css\";\r\n\r\nfunction PostDetailPage() {\r\n  const dispatch = useDispatch();\r\n  const { slug } = useParams();\r\n  const [postContent, setPostContent] = useState(\"\");\r\n  const [postInfo, setPostInfo] = useState(null);\r\n  const [isPending, setIsPending] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const bookmarkItems = useSelector(selectBookmarkItems);\r\n\r\n  const addPostToBookmark = () =>\r\n    dispatch(\r\n      addItemToBookmarks(bookmarkItems, {\r\n        data: postInfo,\r\n        id: slug,\r\n      })\r\n    );\r\n\r\n  useEffect(() => {\r\n    const url = `${process.env.PUBLIC_URL}/contents/posts/${slug}.md`;\r\n    const getContent = fetchData(url, \"md\");\r\n    const getInfo = getPostById(slug);\r\n\r\n    Promise.all([getContent, getInfo])\r\n\r\n      .then((res) => {\r\n        setPostContent(res[0]);\r\n        setPostInfo(res[1]);\r\n      })\r\n\r\n      .catch((error) => {\r\n        console.error(\"ðŸ”¥ Fetch error:\", error);\r\n        setError(error.message);\r\n      })\r\n\r\n      .finally(() => {\r\n        setIsPending(false);\r\n      });\r\n  }, [slug]);\r\n\r\n  return (\r\n    <Fragment>\r\n      {isPending && <p>Loading...</p>}\r\n\r\n      {error && <p>{error}</p>}\r\n\r\n      {postInfo && (\r\n        <Fragment>\r\n          <h1>\r\n            <span>{postInfo.title}</span>\r\n\r\n            <BookmarkIcon\r\n              className={classes[\"bookmark-icon\"]}\r\n              title=\"Bookmark this post\"\r\n              onClick={addPostToBookmark}\r\n            />\r\n\r\n            <div className={classes[\"post-date\"]}>\r\n              Posted on {getShortDate(postInfo.date)}\r\n            </div>\r\n          </h1>\r\n\r\n          <ReactMarkdown\r\n            components={{\r\n              img({ node }) {\r\n                const src = node.properties.src.replace(/^(\\.\\/|\\/)/, \"\");\r\n                return (\r\n                  <span className={classes[\"image-container\"]}>\r\n                    <img\r\n                      src={`${process.env.PUBLIC_URL}/images/posts/${slug}/${src}`}\r\n                      alt={node.properties.alt}\r\n                      width=\"600\"\r\n                      height=\"300\"\r\n                    />\r\n                  </span>\r\n                );\r\n              },\r\n            }}\r\n          >\r\n            {postContent}\r\n          </ReactMarkdown>\r\n\r\n          <Comments comments={postInfo.comments} postId={slug} />\r\n        </Fragment>\r\n      )}\r\n    </Fragment>\r\n  );\r\n}\r\n\r\nexport default PostDetailPage;\r\n","export const fetchData = async (url, dataType) => {\r\n  const response = await fetch(url);\r\n  const resContentType = response.headers.get(\"content-type\") || \"\";\r\n\r\n  if (\r\n    !response.ok ||\r\n    (dataType === \"md\" && !resContentType.includes(\"markdown\")) ||\r\n    (dataType === \"json\" && !resContentType.includes(\"json\"))\r\n  ) {\r\n    return Promise.reject(new Error(\"Fetch Data Failed\"));\r\n  }\r\n  if (dataType === \"md\") {\r\n    return response.text();\r\n  } else if (dataType === \"json\") {\r\n    return response.json();\r\n  }\r\n  return Promise.reject(`Not Support Data Type ${dataType}!`);\r\n};\r\n"],"names":["_ref","postId","userDisplayName","updateComments","isPending","setIsPending","useState","commentRef","useRef","_jsxs","children","_jsx","placeholder","rows","ref","className","classes","onClick","async","newComment","current","value","trim","length","addCommentToPost","alert","disabled","comments","commentsList","setCommentsList","useEffect","dispatch","useDispatch","currentUser","useSelector","selectCurrentUser","signInWithGoogle","useCallback","response","signInWithGooglePopup","setCurrentUser","user","NewComment","displayName","sort","a","b","createdAt","map","c","comment","getLongDate","slug","useParams","postContent","setPostContent","postInfo","setPostInfo","error","setError","bookmarkItems","selectBookmarkItems","getContent","url","dataType","fetch","resContentType","headers","get","ok","includes","Promise","reject","Error","text","json","fetchData","getInfo","getPostById","all","then","res","catch","console","message","finally","Fragment","title","BookmarkIcon","addPostToBookmark","addItemToBookmarks","data","id","getShortDate","date","ReactMarkdown","components","img","node","src","properties","replace","alt","width","height","Comments"],"sourceRoot":""}